var r=function(){return function(r,e){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return function(r,e){var n=[],t=!0,o=!1,i=void 0;try{for(var a,s=r[Symbol.iterator]();!(t=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);t=!0);}catch(r){o=!0,i=r}finally{try{!t&&s.return&&s.return()}finally{if(o)throw i}}return n}(r,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();export default function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!Worker)throw Error("the current runtime does not support web worker");if(!Promise)throw Error("the current runtime does not support Promise");var n=void 0,t=void 0,o=new Map,i=function(r){return r.name},a=Function.prototype.toString,s="\n    self.onmessage = function (e) {\n      const { method, params = [] } = JSON.parse(e.data)\n      try {\n        const result = methods[method].apply(null, params)\n        if (result instanceof Promise) {\n          Promise.resolve(result).then(res => {\n            self.postMessage(JSON.stringify(res))\n          }).catch(e => {\n            throw new Error(e)\n          })\n        } else {\n          self.postMessage(JSON.stringify(result))\n        }\n      } catch (e) {\n        throw new Error(e)\n      }\n    } \n  ";return{add:function(){for(var u=arguments.length,f=Array(u),l=0;u>l;l++)f[l]=arguments[l];f.forEach(function(r){if("function"!=typeof r)throw Error(r+" should be a function");var e=i(r);o.set(e,r)});var c="",h=!0,d=!1,m=void 0;try{for(var v,p=o.entries()[Symbol.iterator]();!(h=(v=p.next()).done);h=!0){var y=r(v.value,2);c+=y[0]+": "+a.call(y[1])+","}}catch(r){d=!0,m=r}finally{try{!h&&p.return&&p.return()}finally{if(d)throw m}}t=URL.createObjectURL(new Blob(["const methods = {"+c+"}\n"+s])),n=new Worker(t,e)},invoke:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!o.has(r))throw Error(r+" is not defined");return new Promise(function(t,o){n.onmessage=function(r){var e=JSON.parse(r.data);t(e)},n.onerror=function(r){o(r.message)},n.postMessage(JSON.stringify({method:r,params:e}))})},terminate:function(){n&&(n.terminate(),n=null),URL.revokeObjectURL(t),o.clear()}}}
